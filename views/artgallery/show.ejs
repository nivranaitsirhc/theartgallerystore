<%-include("../partials/header")%>
<div class="row justify-content-center">
	<div class="container">
		<div class="card>">
			<img src="<%=artgallery.image.secure_url%>" width="400" height="750" class="card-img-top" alt="...">
			<div class="card-body">
				<p class="card-text"><%=artgallery.description%></p>

				<h4 class="card-title wrap-p"><strong><%=artgallery.title%></h4></strong>
				<%if(artgallery.price && artgallery.price > 0){%>
					<h4 class="float-right">&#8369; <%=artgallery.price%></h4>
				<%}%>
				<div>
					<em><a href="/user/<%=artgallery.author.id%>"><strong><%=artgallery.author.fullName%></a></strong></em>
					<small class="d-block"><em>Created: <%=moment(artgallery.created).fromNow()%></em></small>
					<%if(artgallery.created.toString() !== artgallery.modified.toString()){%>
						<small class="d-block"><em>Last Modified: <%=moment(artgallery.modified).fromNow()%></em></small>
					<%}%>
				</div>
				<div class="row my-2 mr-auto">
					<table>
							<tr>
								<td>Type:</td>
								<td><strong><%=artgallery.artType.name%></strong></td>
							</tr>
								<td>Status:</td>
								<td><strong><%=artgallery.status.name%></strong></td>
							<tr>
							</tr>
					</table>
				</div>
			<%if(currentUser && artgallery.author.id.equals(currentUser._id)){%>
				<div class="d-flex align-top my-2">
					<div class="">
						<a class="btn btn-warning btn-md" href="/artgallery/<%=artgallery._id%>/edit">Edit</a>
						<form class="form-inline"action="/artgallery/<%=artgallery._id%>?_method=DELETE" method="POST">
							<button class="btn btn-danger btn-md">Delete</button>
						</form>
					</div>
				</div>
			<%}%>
			</div>
		</div>
	</div>
	<!-- Comments -->
	<div class="container">
		<div class="d-flex">
			<h4>Comments</h4>
			<div class="ml-auto">
				<a class="btn btn-success" href="/artgallery/<%=artgallery._id%>/comments/new">Add new comment</a>
			</div>
		</div>
		<hr class="my-3">
		<div class="container">	
			<% artgallery.comments.forEach((comment)=>{%>
				<div class="row commentBox mb-2">
					<div class="col-lg-10 ">
						<h6><strong><%=comment.title%></strong></h6>
						<h7><strong><em>by: <a href="/user/<%=comment.author.id%>"><%=comment.author.fullName%></a></em></strong></h7>
						<p class="wrap-p"><%=comment.text%></p>
						<small class="text-left d-block">
							<%if(comment.created.toString() === comment.modified.toString()){%>
								<em>Created: <%=moment(comment.created).fromNow()%></em>
							<%} else {%>
								<em>Modified: <%=moment(comment.modified).fromNow()%></em>
							<%}%>
						</small>
					</div>
					<div class="col-lg-2 text-right my-2">
					<%if(currentUser && comment.author.id.equals(currentUser._id)){%>
						<div class="d-inline">
							<a class="btn btn-warning btn-sm" href="/artgallery/<%=artgallery._id%>/comments/<%=comment.id%>/edit">Edit</a>
						</div>
						<div class="d-inline">
							<form class="form-inline"action="/artgallery/<%=artgallery._id%>/comments/<%=comment.id%>?_method=DELETE" method="POST">
								<button class="btn btn-danger btn-sm">Delete</button>
							</form>
						</div>
					<%}%>
					</div>
				</div>	
			<%})%>
		</div>
	</div>
</div>
<%-include("../partials/footer")%>